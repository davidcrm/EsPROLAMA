{% extends 'admin_panel/base.html' %}
{% load static %}

{% block extrahead %}
    {{ form.media }}
{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'css/toast.min.css' %}"/>
    <style>
        div:where(.django-ckeditor-widget, #cke_id_contenido_html) {
            width: 100% !important;
        }
    </style>
{% endblock %}

{% block scripts %}
    <script src="{% static 'js/toast.min.js' %}"></script>
    <script>
        {% for message in messages %}
            const toastMessage = new Toast({
                message: '{{ message }}',
                type: 'success',
            });
            setTimeout(() => {
                toastMessage.toastContainerEl.remove();
            }, 5000);
        {% endfor %}
    </script>
{% endblock %}


{% block content %}

    <div class="container">
        <h1>
            {% if descriptor %}Editar{% else %}Nuevo{% endif %} Descriptor
        </h1>
        <hr>
        <form method="post">
            {% csrf_token %}

            {{ form.as_p }}
            <div class="d-flex justify-content-end w-100">

                {% if descriptor %}
                    <!-- Botón para abrir el modal de eliminar -->
                    <button type="button" class="btn btn-outline-danger me-2" data-bs-toggle="modal"
                            data-bs-target="#confirmarEliminarModal">
                        Eliminar descriptor
                    </button>
                {% endif %}

                <button type="submit" class="btn btn-outline-success">
                    {% if descriptor %}Guardar cambios{% else %}Crear Descriptor{% endif %}
                </button>
            </div>
        </form>

        <!-- Modal de confirmación para eliminar -->
        {% if descriptor %}
            <div class="modal fade" id="confirmarEliminarModal" tabindex="-1"
                 aria-labelledby="confirmarEliminarModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <form method="post" action="{% url 'admin_panel:eliminar_descriptor' descriptor.id %}">
                            {% csrf_token %}
                            <div class="modal-header">
                                <h5 class="modal-title" id="confirmarEliminarModalLabel">Confirmar eliminación</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Cerrar"></button>
                            </div>
                            <div class="modal-body">
                                ¿Estás seguro de que quieres eliminar el descriptor?
                                "<strong>{{ descriptor.titulo }}</strong>"?
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar
                                </button>
                                <button type="submit" class="btn btn-danger">Eliminar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>



{% endblock %}
